{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap 54a84ff72a58e4b79bfb","webpack:///external \"web3\"","webpack:///./src/index.ts","webpack:///./src/oauthhttpprovider.ts","webpack:///external \"Oidc\"","webpack:///./node_modules/xhr2/lib/browser.js"],"names":[],"mappings":"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","file":"bitski.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"web3\"), require(\"Oidc\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"web3\", \"Oidc\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"bitski\"] = factory(require(\"web3\"), require(\"Oidc\"));\n\telse\n\t\troot[\"bitski\"] = factory(root[\"web3\"], root[\"Oidc\"]);\n})(typeof self !== 'undefined' ? self : this, function(__WEBPACK_EXTERNAL_MODULE_0__, __WEBPACK_EXTERNAL_MODULE_3__) {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 1);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 54a84ff72a58e4b79bfb","module.exports = __WEBPACK_EXTERNAL_MODULE_0__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"web3\"\n// module id = 0\n// module chunks = 0","import Web3 from 'web3';\nimport { OAuthHttpProvider } from './oauthhttpprovider';\n\n/**\n * Initialize [Web3](https://github.com/ethereum/web3) with Bitski. This will be ignored if a web3 object already exists.\n * @param {Object} settings\n * @param {string} settings.authority - Authority URL\n * @param {string} settings.client_id - Your unique client ID (sign up at bitski.co)\n * @param {string} settings.redirect_uri - URL to redirect to\n * @param {string} settings.post_logout_redirect_uri - URL to redirect to after log out\n * @param {string} settings.response_type - Response type\n * @param {string} settings.scope - Requested scope\n * @param {string} settings.popup_redirect_uri - URL to redirect to using popup method\n * @param {string} settings.popup_post_logout_redirect_uri - URL to redirect to after log out\n * @param {string} settings.silent_redirect_uri - URL to redirect to using silent method\n * @param {Boolean} settings.automaticSilentRenew - Automatically renew using silent method\n * @param {number} settings.silentRequestTimeout - Timeout for silent request in seconds\n * @param {Boolean} settings.filterProtocolClaims - Filter protocol claims\n * @param {Boolean} settings.loadUserInfo - Whether or not to automatically load the user's info\n * @example\n * // Set up Bitski for exampledapp.co\n * web3 = InitializeWeb3({\n *   authority: 'https://hydra.outtherelabs.com/',\n *   client_id: 'YOUR-CLIENT-ID',\n *   redirect_uri: 'https://exampledapp.co/',\n *   post_logout_redirect_uri: 'https://exampledapp.co',\n *   response_type: 'token id_token',\n *   scope: 'openid',\n *   popup_redirect_uri: 'https://exampledapp.co',\n *   popup_post_logout_redirect_uri: 'https://exampledapp.co',\n *   silent_redirect_uri: 'https://exampledapp.co',\n *   automaticSilentRenew: true,\n *   silentRequestTimeout: 10000,\n *   filterProtocolClaims: true,\n *   loadUserInfo: true\n * });\n * @returns {Web3} Web3 object configured for Bitski.\n */\n\nexport function InitializeWeb3(settings: any) {\n    var provider = new OAuthHttpProvider(\"https://keep-api.outtherelabs.com/v1/web3/kovan\", 0, settings);\n    var web3Client = new Web3(provider);\n    return web3Client;\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.ts","import { Log, UserManager, User } from 'oidc-client';\n\nimport Web3 from 'web3';\nimport 'xhr2';\n\nLog.logger = console;\nLog.level = Log.DEBUG;\n\n\n/**\n * A class that extends Web3's HTTPProvider by adding OAuth to JSON-RPC calls\n * @class\n * @param {string} host - JSON-RPC endpoint\n * @param {number} timeout - Timeout in seconds\n * @param {Object} settings - settings object for configuring OAuth, see {@link InitializeWeb3}\n * @example\n * // Set up a new HTTPOAuthProvider\n * var settings = {\n *   authority: 'https://hydra.outtherelabs.com/',\n *   client_id: 'YOUR-CLIENT-ID',\n *   redirect_uri: 'https://exampledapp.co/',\n *   post_logout_redirect_uri: 'https://exampledapp.co',\n *   response_type: 'token id_token',\n *   scope: 'openid',\n *   popup_redirect_uri: 'https://exampledapp.co',\n *   popup_post_logout_redirect_uri: 'https://exampledapp.co',\n *   silent_redirect_uri: 'https://exampledapp.co',\n *   automaticSilentRenew: true,\n *   silentRequestTimeout: 10000,\n *   filterProtocolClaims: true,\n *   loadUserInfo: true\n * };\n * var provider = new OAuthHttpProvider('https://my-rpc-server.com', 1000, settings);\n */\nexport class OAuthHttpProvider extends Web3.providers.HttpProvider {\n  userManager: UserManager;\n  currentUser: User;\n  host: string;\n\n  constructor(host: string, timeout: number, settings: any) {\n    super(host, timeout);\n\n    var userManager = new UserManager(settings);\n    var provider = this;\n\n    userManager.getUser().then(function (user: User) {\n      if (typeof (user) === 'undefined' || user === null) {\n        throw Error(\"Not signed in\");\n      }\n      \n      return user;\n    }).catch(function (err: any) {\n      if (err.toString() !== \"Error: Not signed in\") {\n        throw err;\n      }\n\n      return new UserManager(settings).signinRedirectCallback();\n    }).catch(function (err: any) {\n      if (err.toString() !== \"Error: No state in response\" && err.toString() !== \"Error: No matching state found in storage\") {\n        throw err;\n      }\n      return userManager.signinRedirect({ state: 'some data' });\n    }).catch(function (err: any) {\n      console.log(\"Error setting up Web3 OAuth\", err);\n      throw err;\n    }).then(function(user: User){\n      provider.currentUser = user;\n    });\n\n    this.userManager = userManager;    \n    this.host = host;\n  }\n\n  _prepareRequest(): XMLHttpRequest {\n    var request = new XMLHttpRequest();\n    request.open('POST', this.host, true);\n    request.setRequestHeader('Content-Type','application/json');\n    if (this.currentUser !== null) {\n      request.setRequestHeader('Authorization', \"Bearer \" + this.currentUser.access_token);\n    }\n    return request\n  }\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/oauthhttpprovider.ts","module.exports = __WEBPACK_EXTERNAL_MODULE_3__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"Oidc\"\n// module id = 3\n// module chunks = 0","module.exports = XMLHttpRequest;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/xhr2/lib/browser.js\n// module id = 4\n// module chunks = 0"],"sourceRoot":""}